<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>6. Hands-on Project - e-Yantra Robotics Competition - ROS2 MOOC</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <!-- 
        <link rel="icon" href="../../favicon.svg">
         -->
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../../style.css">

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = "navy";
            <!-- window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy"; -->
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item affix "><a href="../../welcome.html">Welcome to ROS2 MOOC !</a></li><li class="chapter-item affix "><li class="spacer"></li><li class="chapter-item expanded "><a href="../../GSWR2/GSWR2_welcome.html">Getting Started With ROS2</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../GSWR2/introduction_installation/intro_install.html">Introduction and Installation Setup</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../GSWR2/introduction_installation/humble_installation.html">ROS2 Humble Installation</a></li></ol></li><li class="chapter-item "><a href="../../GSWR2/ros2_design_concepts/ros2_design_concepts.html">ROS2 Design concepts</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../GSWR2/ros2_design_concepts/history_of_ros.html">1. History of ROS</a></li><li class="chapter-item "><a href="../../GSWR2/ros2_design_concepts/diff_ros_1_and_2.html">2. Differences between ROS1 and ROS2</a></li><li class="chapter-item "><a href="../../GSWR2/ros2_design_concepts/dds.html">3. Data Distribution Service (DDS)</a></li><li class="chapter-item "><a href="../../GSWR2/ros2_design_concepts/design_concepts.html">4. ROS2 Design Concepts</a></li></ol></li><li class="chapter-item "><a href="../../GSWR2/ros2_ecosystem_filesystem/ros2_ecosystem_filesystem.html">ROS2 Ecosystem and Filesystem</a></li><li class="chapter-item expanded "><a href="../../GSWR2/ros2_comm_proto/ros2_comm_proto.html">ROS2 Communication Protocols</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../GSWR2/ros2_comm_proto/intro_to_comm_proto.html">1. Introduction to ROS2 Communication Protocols</a></li><li class="chapter-item "><a href="../../GSWR2/ros2_comm_proto/ros2_topics.html">2. ROS2 Topics</a></li><li class="chapter-item "><a href="../../GSWR2/ros2_comm_proto/ros2_services.html">3. ROS2 Services</a></li><li class="chapter-item "><a href="../../GSWR2/ros2_comm_proto/ros2_actions.html">4. ROS2 Actions</a></li><li class="chapter-item "><a href="../../GSWR2/ros2_comm_proto/ros2_comm_compare.html">5. Comparing Topics, Services, and Actions</a></li><li class="chapter-item expanded "><a href="../../GSWR2/ros2_comm_proto/ros2_comm_proj.html" class="active">6. Hands-on Project</a></li></ol></li></ol></li><li class="chapter-item "><li class="spacer"></li><li class="chapter-item "><div>Bonus Blogs!</div><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../bonus_blogs/git_github.html">Git and GitHub</a></li><li class="chapter-item "><a href="../../bonus_blogs/github_challenge.html">Github Challenge</a></li><li class="chapter-item "><a href="../../bonus_blogs/coding_std.html">Coding Standards</a></li></ol></li><li class="chapter-item "><li class="spacer"></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <!-- <html>
 	<head>
 	<style>
 		
 	@media only screen and (max-width: 600px) {
 	  .eyrc_ckt{
 			display:none;
 		}
 	}
 
 	</style>
 	</head>
 	<body>
 		<div>
 		<center></center>
 			<div style="display:flex; justify-content:space-between;padding:10px;padding-top:0">
 				<div >
 					<img src="https://www.e-yantra.org/img/eYantra_logo.svg" alt="e-yantra_logo" height="40px" style="padding:10px 15px;" />
 				</div>
 				<div>
 					<img src="https://raw.githubusercontent.com/kalindkaria/typora-md-assets/master/maze_bot/assets/eyrc-header.svg" height="80px"  class="eyrc_ckt">
 				</div>
 				<div style="font-weight:900;font-size:20px;text-align:center;padding:10px 15px">
 					e-Yantra<br>
 					Robotics Competition
 				</div>
 			</div>
 			
 		</div>
 	</body>
 </html>
 
 
 -->
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar autohide sticky bordered">
                    <div style="width:100%">
                        <html>
                        	<head>
                        	<style>
                        		
                        	@media only screen and (max-width: 600px) {
                        	  .eyrc_ckt{
                        			display:none;
                        		}
                        	}
                        
                        	</style>
                        	</head>
                        	<body>
                        		<div>
                        		<center></center>
                        			<div style="display:flex; justify-content:space-between;padding:10px;padding-top:0">
                        				<div >
                        					<img src="https://www.e-yantra.org/img/eYantra_logo.svg" alt="e-yantra_logo" height="40px" style="padding:10px 15px;" />
                        				</div>
                        				<div>
                        					<img src="https://raw.githubusercontent.com/kalindkaria/typora-md-assets/master/maze_bot/assets/eyrc-header.svg" height="80px"  class="eyrc_ckt">
                        				</div>
                        				<div style="font-weight:900;font-size:20px;text-align:center;padding:10px 15px">
                        					e-Yantra<br>
                        					Robotics Competition
                        				</div>
                        			</div>
                        			
                        		</div>
                        	</body>
                        </html>
                        
                        
                    </div>
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="space">Space</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">e-Yantra Robotics Competition - ROS2 MOOC</h1>

                    <div class="right-buttons">
                        <div id="navigation-buttons" type="button" onclick=" window.open('https://portal.e-yantra.org/profile_home', '_blank')">Home</div>
                        <div id="navigation-buttons" type="button" onclick=" window.open('https://discuss.e-yantra.org/', '_blank')">Forum</div>
                        <div id="navigation-buttons" type="button" onclick=" window.open('https://portal.e-yantra.org/logout', '_blank')">Logout</div>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <!-- <center><img src="http://mooc.e-yantra.org/img/eYantra_logo.svg" alt="e-yantra_logo" style="scale:75%;" /></center> -->
<style>
.back{
	position: fixed;
	width: 250px;
	height: 250px;
	top: 50%;
	left: 50%;
    margin-top: auto; 
    margin-left: auto; 
	opacity: 0.15;
    z-index: -1;
	}
</style>
<!-- <img src="http://mooc.e-yantra.org/img/EyantraLogoMini.png" class="back"> -->
<center>
    <h1 id="hands-on-project-with-ros2-turtlesim-integrative-example"><a class="header" href="#hands-on-project-with-ros2-turtlesim-integrative-example">Hands-on Project with ROS2: Turtlesim Integrative Example</a></h1>
</center>
<hr />
<h3 id="introduction"><a class="header" href="#introduction">Introduction</a></h3>
<blockquote>
<p>This hands-on project will guide you through creating a comprehensive ROS2 application that combines Topics, Services, and Actions using the Turtlesim package. This project is designed to reinforce your understanding of these communication mechanisms and how they can be integrated into a real-world application.</p>
</blockquote>
<h3 id="project-overview"><a class="header" href="#project-overview">Project Overview</a></h3>
<p>In this project, we will create a system that:</p>
<ol>
<li><strong>Publishes</strong> the turtle's pose (position and orientation) to a topic.</li>
<li><strong>Provides a service</strong> to reset the turtle's position to the center of the window.</li>
<li><strong>Implements an action</strong> to move the turtle in a square pattern while providing feedback on its progress.</li>
</ol>
<h3 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h3>
<p>Ensure you have the following installed and set up:</p>
<ul>
<li>ROS2 (Humble)</li>
<li>Turtlesim package</li>
</ul>
<p>You can install the Turtlesim package using:</p>
<pre><code class="language-sh">sudo apt-get install ros-&lt;your_ros2_distro&gt;-turtlesim
</code></pre>
<h3 id="step-1-creating-the-ros2-package"><a class="header" href="#step-1-creating-the-ros2-package">Step 1: Creating the ROS2 Package</a></h3>
<p>First, create a new ROS2 package for our project.</p>
<pre><code class="language-sh">ros2 pkg create --build-type ament_python turtle_project
</code></pre>
<p>Navigate to the package directory:</p>
<pre><code class="language-sh">cd turtle_project
</code></pre>
<h3 id="step-2-setting-up-topics"><a class="header" href="#step-2-setting-up-topics">Step 2: Setting Up Topics</a></h3>
<h4 id="publisher-turtle-pose"><a class="header" href="#publisher-turtle-pose">Publisher: Turtle Pose</a></h4>
<p>Create a Python script named <code>turtle_pose_publisher.py</code> to publish the turtle's pose.</p>
<pre><code class="language-python"># turtle_pose_publisher.py

import rclpy
from rclpy.node import Node
from turtlesim.msg import Pose
from geometry_msgs.msg import PoseStamped

class TurtlePosePublisher(Node):
    def __init__(self):
        super().__init__('turtle_pose_publisher')
        self.publisher_ = self.create_publisher(PoseStamped, 'turtle/pose', 10)
        self.subscription = self.create_subscription(Pose, 'turtle1/pose', self.pose_callback, 10)

    def pose_callback(self, msg):
        pose_stamped = PoseStamped()
        pose_stamped.header.stamp = self.get_clock().now().to_msg()
        pose_stamped.header.frame_id = 'turtle1'
        pose_stamped.pose.position.x = msg.x
        pose_stamped.pose.position.y = msg.y
        pose_stamped.pose.orientation.z = msg.theta
        self.publisher_.publish(pose_stamped)

def main(args=None):
    rclpy.init(args=args)
    node = TurtlePosePublisher()
    rclpy.spin(node)
    node.destroy_node()
    rclpy.shutdown()

if __name__ == '__main__':
    main()
</code></pre>
<h3 id="step-3-setting-up-services"><a class="header" href="#step-3-setting-up-services">Step 3: Setting Up Services</a></h3>
<h4 id="service-reset-turtle-position"><a class="header" href="#service-reset-turtle-position">Service: Reset Turtle Position</a></h4>
<p>Create a Python script named <code>turtle_reset_service.py</code> to reset the turtle's position.</p>
<pre><code class="language-python"># turtle_reset_service.py

import rclpy
from rclpy.node import Node
from std_srvs.srv import Empty

class TurtleResetService(Node):
    def __init__(self):
        super().__init__('turtle_reset_service')
        self.srv = self.create_service(Empty, 'reset_turtle', self.reset_turtle_callback)

    def reset_turtle_callback(self, request, response):
        self.get_logger().info('Resetting turtle position to the center...')
        self.reset_turtle()
        return response

    def reset_turtle(self):
        reset_client = self.create_client(Empty, 'reset')
        while not reset_client.wait_for_service(timeout_sec=1.0):
            self.get_logger().info('Reset service not available, waiting again...')
        req = Empty.Request()
        future = reset_client.call_async(req)
        rclpy.spin_until_future_complete(self, future)
        if future.result() is not None:
            self.get_logger().info('Turtle reset successfully!')
        else:
            self.get_logger().error('Failed to reset turtle!')

def main(args=None):
    rclpy.init(args=args)
    node = TurtleResetService()
    rclpy.spin(node)
    node.destroy_node()
    rclpy.shutdown()

if __name__ == '__main__':
    main()
</code></pre>
<h3 id="step-4-setting-up-actions"><a class="header" href="#step-4-setting-up-actions">Step 4: Setting Up Actions</a></h3>
<h4 id="action-move-turtle-in-square"><a class="header" href="#action-move-turtle-in-square">Action: Move Turtle in Square</a></h4>
<p>Create a Python script named <code>turtle_square_action.py</code> to move the turtle in a square pattern.</p>
<pre><code class="language-python"># turtle_square_action.py

import rclpy
from rclpy.node import Node
from rclpy.action import ActionServer
from rclpy.action import ActionClient
from turtlesim.msg import Pose
from turtlesim.srv import TeleportAbsolute
from example_interfaces.action import MoveTurtleSquare
from geometry_msgs.msg import Twist

class TurtleSquareActionServer(Node):
    def __init__(self):
        super().__init__('turtle_square_action_server')
        self.action_server = ActionServer(
            self,
            MoveTurtleSquare,
            'move_turtle_square',
            self.execute_callback
        )
        self.publisher_ = self.create_publisher(Twist, 'turtle1/cmd_vel', 10)

    def execute_callback(self, goal_handle):
        self.get_logger().info('Executing goal...')
        feedback_msg = MoveTurtleSquare.Feedback()
        result = MoveTurtleSquare.Result()
        side_length = goal_handle.request.side_length

        for i in range(4):
            self.move_straight(side_length)
            self.rotate_90_degrees()
            feedback_msg.current_side = i + 1
            goal_handle.publish_feedback(feedback_msg)

        goal_handle.succeed()
        result.success = True
        return result

    def move_straight(self, distance):
        twist = Twist()
        twist.linear.x = 2.0
        self.publisher_.publish(twist)
        self.get_clock().sleep_for(rclpy.duration.Duration(seconds=distance / twist.linear.x))
        twist.linear.x = 0.0
        self.publisher_.publish(twist)

    def rotate_90_degrees(self):
        twist = Twist()
        twist.angular.z = 1.57  # Approx 90 degrees
        self.publisher_.publish(twist)
        self.get_clock().sleep_for(rclpy.duration.Duration(seconds=1))
        twist.angular.z = 0.0
        self.publisher_.publish(twist)

def main(args=None):
    rclpy.init(args=args)
    node = TurtleSquareActionServer()
    rclpy.spin(node)
    node.destroy_node()
    rclpy.shutdown()

if __name__ == '__main__':
    main()
</code></pre>
<h3 id="step-5-running-the-project"><a class="header" href="#step-5-running-the-project">Step 5: Running the Project</a></h3>
<p>Create an entry point script <code>setup.py</code> in the <code>turtle_project</code> package.</p>
<pre><code class="language-python"># setup.py

from setuptools import setup

package_name = 'turtle_project'

setup(
    name=package_name,
    version='0.0.0',
    packages=[package_name],
    py_modules=[
        'turtle_pose_publisher',
        'turtle_reset_service',
        'turtle_square_action'
    ],
    install_requires=['setuptools'],
    zip_safe=True,
    maintainer='Your Name',
    maintainer_email='your.email@example.com',
    description='Turtle Project with Topics, Services, and Actions',
    license='Apache License 2.0',
    tests_require=['pytest'],
    entry_points={
        'console_scripts': [
            'turtle_pose_publisher = turtle_project.turtle_pose_publisher:main',
            'turtle_reset_service = turtle_project.turtle_reset_service:main',
            'turtle_square_action = turtle_project.turtle_square_action:main'
        ],
    },
)
</code></pre>
<p>Finally, build and source your package:</p>
<pre><code class="language-sh">colcon build
source install/setup.bash
</code></pre>
<h4 id="running-the-nodes"><a class="header" href="#running-the-nodes">Running the Nodes</a></h4>
<p>In separate terminals, run each of the nodes:</p>
<pre><code class="language-sh"># Terminal 1: Run the turtlesim node
ros2 run turtlesim turtlesim_node

# Terminal 2: Run the pose publisher
ros2 run turtle_project turtle_pose_publisher

# Terminal 3: Run the reset service
ros2 run turtle_project turtle_reset_service

# Terminal 4: Run the square action server
ros2 run turtle_project turtle_square_action
</code></pre>
<h3 id="conclusion"><a class="header" href="#conclusion">Conclusion</a></h3>
<blockquote>
<p>This hands-on project provides a comprehensive example of how to integrate Topics, Services, and Actions in a ROS2 application using Turtlesim. By working through this project, you will gain practical experience in setting up and utilizing these communication mechanisms, reinforcing your understanding and preparing you for more complex real-world applications.</p>
</blockquote>
<hr />

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../GSWR2/ros2_comm_proto/ros2_comm_compare.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../../bonus_blogs/git_github.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../GSWR2/ros2_comm_proto/ros2_comm_compare.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../bonus_blogs/git_github.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script type="text/javascript">
            window.playground_copyable = true;
        </script>


        <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../../sidebar.js"></script>


    </body>
</html>
